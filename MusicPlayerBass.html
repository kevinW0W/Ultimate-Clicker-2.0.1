<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Bass Booster Pro | Secure</title>
    <style>
        :root {
            --primary: #00e5ff;
            --bg: #0b0f1a;
            --card: #161b2e;
            --text: #f8fafc;
            --accent: #2d3748;
            --success: #10b981;
            --danger: #ff4d4d;
        }

        body {
            font-family: -apple-system, system-ui, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* --- Verification Screen --- */
        #shield-screen {
            position: fixed;
            inset: 0;
            background: var(--bg);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .captcha-widget {
            background: #f9f9f9;
            border: 1px solid #d3d3d3;
            border-radius: 3px;
            width: 300px;
            height: 74px;
            display: flex;
            align-items: center;
            padding: 0 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            user-select: none;
        }

        .checkbox-container {
            width: 28px;
            height: 28px;
            border: 2px solid #c1c1c1;
            border-radius: 2px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid #4d90fe;
            border-top: 3px solid transparent;
            border-radius: 50%;
            display: none;
            animation: spin 0.8s linear infinite;
        }

        .checkmark {
            width: 22px;
            height: 22px;
            fill: var(--success);
            display: none;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .captcha-text { color: #333; font-size: 14px; flex-grow: 1; }

        /* --- Player UI (Optimized for iPad/Tablet) --- */
        .player-card {
            background: var(--card);
            width: 95%;
            max-width: 900px;
            height: 85vh;
            max-height: 600px;
            border-radius: 24px;
            display: none; 
            flex-direction: row;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.05);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .sidebar {
            width: 220px;
            background: rgba(0,0,0,0.2);
            border-right: 1px solid var(--accent);
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .sidebar-header {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .main-content {
            flex: 1;
            padding: 30px;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            overflow: hidden;
            align-items: center;
        }

        .viz-circle {
            width: 35vh;
            height: 35vh;
            max-width: 200px;
            max-height: 200px;
            flex-shrink: 0;
            border-radius: 50%;
            background: #000;
            border: 6px solid var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.05s ease-out;
            box-shadow: 0 0 40px rgba(0, 229, 255, 0.2);
            position: relative;
        }

        /* --- Scrolling Marquee --- */
        .track-info-container {
            text-align: center;
            overflow: hidden;
            width: 80%;
            height: 60px;
            position: relative;
        }

        .marquee-wrapper {
            white-space: nowrap;
            display: inline-block;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .marquee-wrapper.scrolling {
            animation: marquee 8s linear infinite;
            left: 100%;
            transform: translateX(0);
        }

        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }

        .controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            width: 100%;
        }

        .btn {
            background: var(--accent);
            border: none;
            color: white;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .btn:active { transform: scale(0.9); }

        .btn-play {
            width: 65px;
            height: 65px;
            background: var(--primary);
            color: var(--bg);
            font-size: 1.5rem;
        }

        .btn-small {
            width: 100%;
            border-radius: 8px;
            font-size: 0.75rem;
            height: 38px;
            font-weight: 600;
        }

        .btn-danger {
            background: rgba(255, 77, 77, 0.1);
            color: var(--danger);
        }

        .booster-controls {
            width: 100%;
            max-width: 400px;
        }

        .slider-group {
            background: rgba(0,0,0,0.3);
            padding: 12px 18px;
            border-radius: 16px;
            margin-bottom: 8px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.65rem;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #94a3b8;
        }

        input[type=range] {
            width: 100%;
            height: 5px;
            background: var(--accent);
            border-radius: 3px;
            appearance: none;
            outline: none;
        }

        input[type=range]::-webkit-slider-thumb {
            appearance: none;
            width: 16px;
            height: 16px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px var(--primary);
        }

        #playlist-container {
            flex: 1;
            overflow-y: auto;
            margin-top: 10px;
        }

        .song-item {
            padding: 12px;
            font-size: 0.8rem;
            border-radius: 10px;
            cursor: pointer;
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s;
            background: rgba(255,255,255,0.02);
        }

        .song-item span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 140px;
        }

        .song-item.active { background: rgba(0, 229, 255, 0.15); color: var(--primary); font-weight: 600; }

        .item-remove {
            color: var(--danger);
            font-size: 1.1rem;
            padding: 4px 8px;
            border-radius: 6px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .song-item:hover .item-remove { opacity: 1; }
        .item-remove:hover { background: rgba(255, 77, 77, 0.2); }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: var(--accent);
            border-radius: 3px;
            cursor: pointer;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            border-radius: 3px;
            box-shadow: 0 0 8px var(--primary);
        }
    </style>
</head>
<body>

    <div id="shield-screen">
        <div class="captcha-widget" onclick="handleVerify()">
            <div class="checkbox-container" id="cap-box">
                <div class="spinner" id="cap-spinner"></div>
                <svg class="checkmark" id="cap-check" viewBox="0 0 24 24">
                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                </svg>
            </div>
            <div class="captcha-text">I'm not a robot</div>
            <div style="font-size: 8px; color: #777; text-align: center;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="#4d90fe"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm4.59-12.42L10 14.17l-2.59-2.58L6 13l4 4 8-8z"/></svg><br>reCAPTCHA
            </div>
        </div>
    </div>

    <div class="player-card" id="app-root">
        <div class="sidebar">
            <div class="sidebar-header">
                <button class="btn btn-small" onclick="document.getElementById('f-upload').click()">+ IMPORT</button>
                <button class="btn btn-small btn-danger" onclick="clearQueue()">CLEAR</button>
            </div>
            <div id="playlist-container"></div>
        </div>

        <div class="main-content">
            <div class="viz-circle" id="viz-disk">
                <svg width="60" height="60" viewBox="0 0 24 24" fill="var(--primary)"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 14.5c-2.49 0-4.5-2.01-4.5-4.5S9.51 7.5 12 7.5s4.5 2.01 4.5 4.5-2.01 4.5-4.5 4.5zm0-5.5c-.55 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"/></svg>
            </div>

            <div class="track-info-container">
                <div class="marquee-wrapper" id="track-marquee">
                    <h2 id="track-name" style="margin: 0; font-size: 1.2rem; color: var(--primary);">NO TRACK</h2>
                </div>
                <p id="track-artist" style="color: #64748b; margin: 5px 0; font-size: 0.8rem; text-align: center;">Select files to begin</p>
            </div>

            <div class="progress-bar" onclick="seek(event)">
                <div class="progress-fill" id="progress-fill"></div>
            </div>

            <div class="controls">
                <button class="btn" onclick="prev()">⏮</button>
                <button class="btn btn-play" id="play-btn" onclick="togglePlay()">▶</button>
                <button class="btn" onclick="next()">⏭</button>
            </div>

            <div class="booster-controls">
                <div class="slider-group">
                    <div class="slider-label"><span>Bass Boost</span><span id="bass-val">0%</span></div>
                    <input type="range" min="0" max="100" value="0" oninput="updateBass(this.value)">
                </div>
                <div class="slider-group">
                    <div class="slider-label"><span>Volume</span><span id="vol-val">100%</span></div>
                    <input type="range" min="0" max="150" value="100" oninput="updateVol(this.value)">
                </div>
            </div>
        </div>
    </div>

    <input type="file" id="f-upload" multiple accept="audio/*" style="display:none" onchange="handleFiles(event)">

    <script>
        let isVerified = false;
        function handleVerify() {
            if(isVerified) return;
            const spinner = document.getElementById('cap-spinner');
            const check = document.getElementById('cap-check');
            spinner.style.display = 'block';
            setTimeout(() => {
                spinner.style.display = 'none';
                check.style.display = 'block';
                isVerified = true;
                setTimeout(() => {
                    document.getElementById('shield-screen').style.display = 'none';
                    document.getElementById('app-root').style.display = 'flex';
                    initAudio();
                }, 500);
            }, 1200);
        }

        let audioCtx, audio, source, bassShelf, bassPeak, gainNode, compressor, playlist = [], currentIndex = -1;

        function initAudio() {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            audio = new Audio();
            source = audioCtx.createMediaElementSource(audio);
            
            bassShelf = audioCtx.createBiquadFilter();
            bassShelf.type = "lowshelf";
            bassShelf.frequency.value = 200;
            
            bassPeak = audioCtx.createBiquadFilter();
            bassPeak.type = "peaking";
            bassPeak.frequency.value = 55;
            bassPeak.Q.value = 2.0;

            gainNode = audioCtx.createGain();
            compressor = audioCtx.createDynamicsCompressor();

            source.connect(bassShelf).connect(bassPeak).connect(gainNode).connect(compressor).connect(audioCtx.destination);

            audio.addEventListener('timeupdate', () => {
                const pct = (audio.currentTime / audio.duration) * 100 || 0;
                document.getElementById('progress-fill').style.width = pct + "%";
                const bounce = 1 + (bassPeak.gain.value / 40) * 0.15;
                document.getElementById('viz-disk').style.transform = `scale(${bounce})`;
            });
            audio.onended = next;
        }

        function handleFiles(e) {
            const files = Array.from(e.target.files);
            playlist = [...playlist, ...files];
            renderPlaylist();
            if(currentIndex === -1) playTrack(0);
        }

        function renderPlaylist() {
            const container = document.getElementById('playlist-container');
            container.innerHTML = playlist.map((f, i) => `
                <div class="song-item ${i === currentIndex ? 'active' : ''}" onclick="playTrack(${i})">
                    <span>${f.name}</span>
                    <div class="item-remove" onclick="removeTrack(${i}, event)">×</div>
                </div>
            `).join('');
        }

        function removeTrack(index, e) {
            e.stopPropagation();
            playlist.splice(index, 1);
            if (index === currentIndex) {
                if (playlist.length > 0) next();
                else clearQueue();
            } else if (index < currentIndex) {
                currentIndex--;
            }
            renderPlaylist();
        }

        function clearQueue() {
            audio.pause();
            audio.src = "";
            playlist = [];
            currentIndex = -1;
            document.getElementById('track-name').innerText = "NO TRACK";
            document.getElementById('track-marquee').classList.remove('scrolling');
            document.getElementById('play-btn').innerText = "▶";
            renderPlaylist();
        }

        function playTrack(i) {
            if (i < 0 || i >= playlist.length) return;
            if(audioCtx.state === 'suspended') audioCtx.resume();
            currentIndex = i;
            const file = playlist[i];
            audio.src = URL.createObjectURL(file);
            
            const nameEl = document.getElementById('track-name');
            const marquee = document.getElementById('track-marquee');
            const name = file.name.split('.')[0].toUpperCase();
            
            nameEl.innerText = name;
            marquee.classList.remove('scrolling');
            
            // Re-trigger marquee if text is long
            setTimeout(() => {
                if(name.length > 18) marquee.classList.add('scrolling');
            }, 50);

            document.getElementById('play-btn').innerText = "||";
            audio.play();
            renderPlaylist();
        }

        function togglePlay() {
            if(!audio.src) return;
            if(audio.paused) { audio.play(); document.getElementById('play-btn').innerText = "||"; }
            else { audio.pause(); document.getElementById('play-btn').innerText = "▶"; }
        }

        function updateBass(v) {
            bassShelf.gain.setTargetAtTime((v/100)*15, audioCtx.currentTime, 0.1);
            bassPeak.gain.setTargetAtTime((v/100)*25, audioCtx.currentTime, 0.1);
            document.getElementById('bass-val').innerText = v + "%";
        }

        function updateVol(v) {
            gainNode.gain.setTargetAtTime(v/100, audioCtx.currentTime, 0.1);
            document.getElementById('vol-val').innerText = v + "%";
        }

        function seek(e) {
            if(!audio.duration) return;
            const rect = e.currentTarget.getBoundingClientRect();
            audio.currentTime = ((e.clientX - rect.left) / rect.width) * audio.duration;
        }

        function next() { if(playlist.length) playTrack((currentIndex + 1) % playlist.length); }
        function prev() { if(playlist.length) playTrack((currentIndex - 1 + playlist.length) % playlist.length); }
    </script>
</body>
</html>
